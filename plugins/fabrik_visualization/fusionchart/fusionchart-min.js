/*! Fabrik */

define(["jquery","fab/fabrik","fusionchart"],function(t,a,i){return new Class({Implements:[Options],options:{chartJSON:"{}",chartType:"pie2d",chartWidth:"100%",chartHeight:"100%",chartID:"FusionChart",chartContainer:"chart-container"},chart:null,initialize:function(t,i){this.setOptions(i),this.updater=new Request.JSON({url:"",data:{option:"com_fabrik",format:"raw",task:"ajax_getFusionchart",view:"visualization",controller:"visualization.fusionchart",visualizationid:this.options.id},onSuccess:function(t){a.fireEvent("fabrik.viz.fusionchart.ajax.refresh",[this]),a.loader.stop(this.options.chartContainer),this.chart.setJSONData(t)}.bind(this)}),this.render()},render:function(){this.chart=new FusionCharts({type:this.options.chartType,id:this.options.chartID,width:this.options.chartWidth,height:this.options.chartHeight,renderAt:this.options.chartContainer,dataFormat:"json",dataSource:this.options.chartJSON}),FusionCharts(this.options.chartID).render()},update:function(){a.loader.start(this.options.chartContainer);var i=this;t.ajax({url:"",method:"post",dataType:"json",data:{option:"com_fabrik",format:"raw",task:"ajax_getFusionchart",view:"visualization",controller:"visualization.fusionchart",visualizationid:i.options.id}}).always(function(){a.loader.stop(i.options.chartContainer)}).fail(function(t,i,a){window.alert(i)}).done(function(t){a.fireEvent("fabrik.viz.fusionchart.ajax.refresh",[this]),i.chart.setJSONData(t)})}})});